{
  "info": {
    "name": "E-Commerce API - Complete Collection",
    "description": "Complete collection of all API endpoints for the E-Commerce API with dummy test data",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8000",
      "type": "string"
    },
    {
      "key": "authToken",
      "value": "",
      "type": "string"
    },
    {
      "key": "userId",
      "value": "",
      "type": "string"
    },
    {
      "key": "categoryId",
      "value": "",
      "type": "string"
    },
    {
      "key": "subCategoryId",
      "value": "",
      "type": "string"
    },
    {
      "key": "brandId",
      "value": "",
      "type": "string"
    },
    {
      "key": "productId",
      "value": "",
      "type": "string"
    },
    {
      "key": "reviewId",
      "value": "",
      "type": "string"
    },
    {
      "key": "couponId",
      "value": "",
      "type": "string"
    },
    {
      "key": "cartId",
      "value": "",
      "type": "string"
    },
    {
      "key": "orderId",
      "value": "",
      "type": "string"
    }
  ],
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{authToken}}",
        "type": "string"
      }
    ]
  },
  "item": [
    {
      "name": "Authentication",
      "item": [
        {
          "name": "User Signup",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"John Doe\",\n  \"email\": \"john.doe@example.com\",\n  \"password\": \"password123\",\n  \"passwordConfirm\": \"password123\",\n  \"phone\": \"+201234567890\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/signup",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "signup"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// Safe test script with error handling",
                  "try {",
                  "    if (pm.response && pm.response.code === 201) {",
                  "        const responseJson = pm.response.json();",
                  "        if (responseJson && responseJson.token) {",
                  "            pm.collectionVariables.set('authToken', responseJson.token);",
                  "        }",
                  "        if (responseJson && responseJson.data && responseJson.data._id) {",
                  "            pm.collectionVariables.set('userId', responseJson.data._id);",
                  "        }",
                  "    }",
                  "} catch (error) {",
                  "    console.error('Test script error:', error.message);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "User Login",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"john.doe@example.com\",\n  \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "login"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// Safe test script with error handling",
                  "try {",
                  "    if (pm.response && pm.response.code === 200) {",
                  "        const responseJson = pm.response.json();",
                  "        if (responseJson && responseJson.token) {",
                  "            pm.collectionVariables.set('authToken', responseJson.token);",
                  "        }",
                  "        if (responseJson && responseJson.data && responseJson.data._id) {",
                  "            pm.collectionVariables.set('userId', responseJson.data._id);",
                  "        }",
                  "    }",
                  "} catch (error) {",
                  "    console.error('Test script error:', error.message);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Admin Login",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"admin@example.com\",\n  \"password\": \"admin123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "login"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "// Safe test script with error handling",
                  "try {",
                  "    if (pm.response && pm.response.code === 200) {",
                  "        const responseJson = pm.response.json();",
                  "        if (responseJson && responseJson.token) {",
                  "            pm.collectionVariables.set('authToken', responseJson.token);",
                  "        }",
                  "    }",
                  "} catch (error) {",
                  "    console.error('Test script error:', error.message);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Forgot Password",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"john.doe@example.com\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/forgotPassword",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "forgotPassword"]
            }
          }
        },
        {
          "name": "Verify Reset Code",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"resetCode\": \"123456\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/verifyResetCode",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "verifyResetCode"]
            }
          }
        },
        {
          "name": "Reset Password",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"john.doe@example.com\",\n  \"newPassword\": \"newpassword123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/auth/resetPassword",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "auth", "resetPassword"]
            }
          }
        }
      ]
    },
    {
      "name": "Categories",
      "item": [
        {
          "name": "Get All Categories",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/categories",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "categories"]
            }
          }
        },
        {
          "name": "Get Category by ID",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/categories/{{categoryId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "categories", "{{categoryId}}"]
            }
          }
        },
        {
          "name": "Create Category",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Electronics\",\n  \"image\": \"electronics.jpg\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/categories",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "categories"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const responseJson = pm.response.json();",
                  "    pm.collectionVariables.set('categoryId', responseJson.data._id);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Update Category",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Updated Electronics\",\n  \"image\": \"updated-electronics.jpg\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/categories/{{categoryId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "categories", "{{categoryId}}"]
            }
          }
        },
        {
          "name": "Delete Category",
          "request": {
            "method": "DELETE",
            "url": {
              "raw": "{{baseUrl}}/api/v1/categories/{{categoryId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "categories", "{{categoryId}}"]
            }
          }
        }
      ]
    },
    {
      "name": "SubCategories",
      "item": [
        {
          "name": "Get All SubCategories",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/subcategories",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "subcategories"]
            }
          }
        },
        {
          "name": "Get SubCategories by Category",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/categories/{{categoryId}}/subcategories",
              "host": ["{{baseUrl}}"],
              "path": [
                "api",
                "v1",
                "categories",
                "{{categoryId}}",
                "subcategories"
              ]
            }
          }
        },
        {
          "name": "Get SubCategory by ID",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/subcategories/{{subCategoryId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "subcategories", "{{subCategoryId}}"]
            }
          }
        },
        {
          "name": "Create SubCategory",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Smartphones\",\n  \"category\": \"{{categoryId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/subcategories",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "subcategories"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const responseJson = pm.response.json();",
                  "    pm.collectionVariables.set('subCategoryId', responseJson.data._id);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Update SubCategory",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Updated Smartphones\",\n  \"category\": \"{{categoryId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/subcategories/{{subCategoryId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "subcategories", "{{subCategoryId}}"]
            }
          }
        },
        {
          "name": "Delete SubCategory",
          "request": {
            "method": "DELETE",
            "url": {
              "raw": "{{baseUrl}}/api/v1/subcategories/{{subCategoryId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "subcategories", "{{subCategoryId}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Brands",
      "item": [
        {
          "name": "Get All Brands",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/brands",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "brands"]
            }
          }
        },
        {
          "name": "Get Brand by ID",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/brands/{{brandId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "brands", "{{brandId}}"]
            }
          }
        },
        {
          "name": "Create Brand",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Apple\",\n  \"image\": \"apple-logo.jpg\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/brands",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "brands"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const responseJson = pm.response.json();",
                  "    pm.collectionVariables.set('brandId', responseJson.data._id);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Update Brand",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Apple Inc.\",\n  \"image\": \"apple-updated-logo.jpg\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/brands/{{brandId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "brands", "{{brandId}}"]
            }
          }
        },
        {
          "name": "Delete Brand",
          "request": {
            "method": "DELETE",
            "url": {
              "raw": "{{baseUrl}}/api/v1/brands/{{brandId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "brands", "{{brandId}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Products",
      "item": [
        {
          "name": "Get All Products",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/products?page=1&limit=10",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "products"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            }
          }
        },
        {
          "name": "Get Products with Filters",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/products?price[gte]=10&price[lte]=100&category={{categoryId}}&sort=-ratingsAverage",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "products"],
              "query": [
                {
                  "key": "price[gte]",
                  "value": "10"
                },
                {
                  "key": "price[lte]",
                  "value": "100"
                },
                {
                  "key": "category",
                  "value": "{{categoryId}}"
                },
                {
                  "key": "sort",
                  "value": "-ratingsAverage"
                }
              ]
            }
          }
        },
        {
          "name": "Get Product by ID",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/products/{{productId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "products", "{{productId}}"]
            }
          }
        },
        {
          "name": "Create Product",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"iPhone 14 Pro\",\n  \"description\": \"The latest iPhone with advanced camera system and A16 Bionic chip\",\n  \"quantity\": 50,\n  \"price\": 999.99,\n  \"priceAfterDiscount\": 899.99,\n  \"variants\": [\"Deep Purple\", \"Gold\", \"Silver\", \"Space Black\"],\n  \"imageCover\": \"iphone14pro-cover.jpg\",\n  \"images\": [\"iphone14pro-1.jpg\", \"iphone14pro-2.jpg\", \"iphone14pro-3.jpg\"],\n  \"category\": \"{{categoryId}}\",\n  \"subcategories\": [\"{{subCategoryId}}\"],\n  \"brand\": \"{{brandId}}\",\n  \"ratingsAverage\": 4.8,\n  \"ratingsQuantity\": 120\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/products",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "products"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const responseJson = pm.response.json();",
                  "    pm.collectionVariables.set('productId', responseJson.data._id);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Update Product",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"iPhone 14 Pro Max\",\n  \"price\": 1099.99,\n  \"priceAfterDiscount\": 999.99,\n  \"quantity\": 30\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/products/{{productId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "products", "{{productId}}"]
            }
          }
        },
        {
          "name": "Delete Product",
          "request": {
            "method": "DELETE",
            "url": {
              "raw": "{{baseUrl}}/api/v1/products/{{productId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "products", "{{productId}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Users",
      "item": [
        {
          "name": "Get All Users (Admin)",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/users",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "users"]
            }
          }
        },
        {
          "name": "Get User by ID",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/users/{{userId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "users", "{{userId}}"]
            }
          }
        },
        {
          "name": "Create User (Admin)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Jane Smith\",\n  \"email\": \"jane.smith@example.com\",\n  \"password\": \"password123\",\n  \"passwordConfirm\": \"password123\",\n  \"phone\": \"+201987654321\",\n  \"role\": \"manager\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/users",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "users"]
            }
          }
        },
        {
          "name": "Update User",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Jane Smith Updated\",\n  \"phone\": \"+201987654322\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/users/{{userId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "users", "{{userId}}"]
            }
          }
        },
        {
          "name": "Change User Password",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"currentPassword\": \"password123\",\n  \"password\": \"newpassword123\",\n  \"passwordConfirm\": \"newpassword123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/users/changePassword/{{userId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "users", "changePassword", "{{userId}}"]
            }
          }
        },
        {
          "name": "Get My Profile",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/users/getMe",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "users", "getMe"]
            }
          }
        },
        {
          "name": "Update My Profile",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"John Doe Updated\",\n  \"phone\": \"+201234567891\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/users/updateMe",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "users", "updateMe"]
            }
          }
        },
        {
          "name": "Change My Password",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"password\": \"newpassword456\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/users/changeMyPassword",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "users", "changeMyPassword"]
            }
          }
        },
        {
          "name": "Delete My Account",
          "request": {
            "method": "DELETE",
            "url": {
              "raw": "{{baseUrl}}/api/v1/users/deleteMe",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "users", "deleteMe"]
            }
          }
        },
        {
          "name": "Delete User (Admin)",
          "request": {
            "method": "DELETE",
            "url": {
              "raw": "{{baseUrl}}/api/v1/users/{{userId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "users", "{{userId}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Reviews",
      "item": [
        {
          "name": "Get All Reviews",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/reviews",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "reviews"]
            }
          }
        },
        {
          "name": "Get Product Reviews",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/products/{{productId}}/reviews",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "products", "{{productId}}", "reviews"]
            }
          }
        },
        {
          "name": "Get Review by ID",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/reviews/{{reviewId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "reviews", "{{reviewId}}"]
            }
          }
        },
        {
          "name": "Create Review",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Great Product!\",\n  \"ratings\": 5,\n  \"product\": \"{{productId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/reviews",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "reviews"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const responseJson = pm.response.json();",
                  "    pm.collectionVariables.set('reviewId', responseJson.data._id);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Update Review",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Updated Review\",\n  \"ratings\": 4\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/reviews/{{reviewId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "reviews", "{{reviewId}}"]
            }
          }
        },
        {
          "name": "Delete Review",
          "request": {
            "method": "DELETE",
            "url": {
              "raw": "{{baseUrl}}/api/v1/reviews/{{reviewId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "reviews", "{{reviewId}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Wishlist",
      "item": [
        {
          "name": "Get My Wishlist",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/wishlist",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "wishlist"]
            }
          }
        },
        {
          "name": "Add Product to Wishlist",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"productId\": \"{{productId}}\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/wishlist",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "wishlist"]
            }
          }
        },
        {
          "name": "Remove Product from Wishlist",
          "request": {
            "method": "DELETE",
            "url": {
              "raw": "{{baseUrl}}/api/v1/wishlist/{{productId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "wishlist", "{{productId}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Addresses",
      "item": [
        {
          "name": "Get My Addresses",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/addresses",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "addresses"]
            }
          }
        },
        {
          "name": "Add Address",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"alias\": \"Home\",\n  \"details\": \"123 Main Street, Apartment 4B\",\n  \"phone\": \"+201234567890\",\n  \"city\": \"Cairo\",\n  \"postalCode\": \"12345\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/addresses",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "addresses"]
            }
          }
        },
        {
          "name": "Remove Address",
          "request": {
            "method": "DELETE",
            "url": {
              "raw": "{{baseUrl}}/api/v1/addresses/ADDRESS_ID",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "addresses", "ADDRESS_ID"]
            }
          }
        }
      ]
    },
    {
      "name": "Coupons",
      "item": [
        {
          "name": "Get All Coupons (Admin)",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/coupons",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "coupons"]
            }
          }
        },
        {
          "name": "Get Coupon by ID",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/coupons/{{couponId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "coupons", "{{couponId}}"]
            }
          }
        },
        {
          "name": "Create Coupon (Admin)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"SAVE20\",\n  \"expire\": \"2024-12-31T23:59:59.000Z\",\n  \"discount\": 20\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/coupons",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "coupons"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const responseJson = pm.response.json();",
                  "    pm.collectionVariables.set('couponId', responseJson.data._id);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Update Coupon (Admin)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"SAVE25\",\n  \"discount\": 25\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/coupons/{{couponId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "coupons", "{{couponId}}"]
            }
          }
        },
        {
          "name": "Delete Coupon (Admin)",
          "request": {
            "method": "DELETE",
            "url": {
              "raw": "{{baseUrl}}/api/v1/coupons/{{couponId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "coupons", "{{couponId}}"]
            }
          }
        }
      ]
    },
    {
      "name": "Cart",
      "item": [
        {
          "name": "Get My Cart",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/cart",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "cart"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const responseJson = pm.response.json();",
                  "    if (responseJson.data) {",
                  "        pm.collectionVariables.set('cartId', responseJson.data._id);",
                  "    }",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Add Product to Cart",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"productId\": \"{{productId}}\",\n  \"variant\": \"Deep Purple\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/cart",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "cart"]
            }
          }
        },
        {
          "name": "Update Cart Item Quantity",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"quantity\": 3\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/cart/ITEM_ID",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "cart", "ITEM_ID"]
            }
          }
        },
        {
          "name": "Remove Item from Cart",
          "request": {
            "method": "DELETE",
            "url": {
              "raw": "{{baseUrl}}/api/v1/cart/ITEM_ID",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "cart", "ITEM_ID"]
            }
          }
        },
        {
          "name": "Clear Cart",
          "request": {
            "method": "DELETE",
            "url": {
              "raw": "{{baseUrl}}/api/v1/cart",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "cart"]
            }
          }
        },
        {
          "name": "Apply Coupon to Cart",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"coupon\": \"SAVE20\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/cart/applyCoupon",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "cart", "applyCoupon"]
            }
          }
        }
      ]
    },
    {
      "name": "Orders",
      "item": [
        {
          "name": "Get All Orders",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/orders",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "orders"]
            }
          }
        },
        {
          "name": "Get Order by ID",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/orders/{{orderId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "orders", "{{orderId}}"]
            }
          }
        },
        {
          "name": "Create Cash Order",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"shippingAddress\": {\n    \"details\": \"123 Main Street, Apartment 4B\",\n    \"phone\": \"+201234567890\",\n    \"city\": \"Cairo\",\n    \"postalCode\": \"12345\"\n  }\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/orders/{{cartId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "orders", "{{cartId}}"]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const responseJson = pm.response.json();",
                  "    pm.collectionVariables.set('orderId', responseJson.data._id);",
                  "}"
                ]
              }
            }
          ]
        },
        {
          "name": "Get Checkout Session (Stripe)",
          "request": {
            "method": "GET",
            "url": {
              "raw": "{{baseUrl}}/api/v1/orders/checkout-session/{{cartId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "orders", "checkout-session", "{{cartId}}"]
            }
          }
        },
        {
          "name": "Update Order to Paid (Admin)",
          "request": {
            "method": "PUT",
            "url": {
              "raw": "{{baseUrl}}/api/v1/orders/{{orderId}}/pay",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "orders", "{{orderId}}", "pay"]
            }
          }
        },
        {
          "name": "Update Order to Delivered (Admin)",
          "request": {
            "method": "PUT",
            "url": {
              "raw": "{{baseUrl}}/api/v1/orders/{{orderId}}/deliver",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "orders", "{{orderId}}", "deliver"]
            }
          }
        }
      ]
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Global pre-request script for E-Commerce API",
          "// This script runs before every request in the collection",
          "",
          "// Ensure base URL is set",
          "if (!pm.collectionVariables.get('baseUrl')) {",
          "    pm.collectionVariables.set('baseUrl', 'http://localhost:8000');",
          "}",
          "",
          "// Add authentication header if token exists",
          "const authToken = pm.collectionVariables.get('authToken');",
          "if (authToken && authToken.trim() !== '') {",
          "    pm.request.headers.add({",
          "        key: 'Authorization',",
          "        value: `Bearer ${authToken}`",
          "    });",
          "}",
          "",
          "// Debug information",
          "console.log('Pre-request script executed');",
          "console.log('Base URL:', pm.collectionVariables.get('baseUrl'));",
          "console.log('Auth Token:', authToken ? 'Present' : 'Not set');"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Global test script for E-Commerce API",
          "// This script runs after every request in the collection",
          "",
          "// Basic response validation",
          "try {",
          "    if (pm.response) {",
          "        // Log response details",
          "        console.log('Response Status:', pm.response.status);",
          "        console.log('Response Time:', pm.response.responseTime + 'ms');",
          "        ",
          "        // Test for successful response codes",
          "        pm.test('Status code is valid', function () {",
          "            pm.expect(pm.response.code).to.be.oneOf([200, 201, 204, 400, 401, 403, 404, 422, 500]);",
          "        });",
          "        ",
          "        // Test for reasonable response time",
          "        pm.test('Response time is reasonable', function () {",
          "            pm.expect(pm.response.responseTime).to.be.below(5000);",
          "        });",
          "        ",
          "        // Test for JSON response when expected",
          "        if (pm.response.headers.get('Content-Type') && pm.response.headers.get('Content-Type').includes('application/json')) {",
          "            pm.test('Response is valid JSON', function () {",
          "                pm.response.to.be.json;",
          "            });",
          "        }",
          "    }",
          "} catch (error) {",
          "    console.error('Global test script error:', error.message);",
          "}"
        ]
      }
    }
  ]
}
